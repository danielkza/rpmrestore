<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org" />

  <title></title>
  <meta http-equiv="content-type" content=
  "text/html; charset=utf-8" />
  <link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">
  <table border="0" width="100%" cellspacing="0" cellpadding="3"
  summary="">
    <tr>
      <td class="_podblock_" style="background-color: #cccccc"
      valign="middle"><big><strong><span class=
      "_podblock_">&nbsp;</span></strong></big></td>
    </tr>
  </table>

  <ul id="index">
    <li><a href="#NAME">NAME</a></li>

    <li><a href="#DESCRIPTION">DESCRIPTION</a></li>

    <li><a href="#SYNOPSIS">SYNOPSIS</a></li>

    <li><a href="#REQUIRED-ARGUMENTS">REQUIRED ARGUMENTS</a></li>

    <li><a href="#OPTIONS">OPTIONS</a></li>

    <li><a href="#USAGE">USAGE</a></li>

    <li><a href="#CONFIGURATION">CONFIGURATION</a></li>

    <li><a href="#NOTES">NOTES</a></li>

    <li><a href="#DIAGNOSTICS">DIAGNOSTICS</a></li>

    <li><a href="#EXIT-STATUS">EXIT STATUS</a></li>

    <li><a href="#DEPENDENCIES">DEPENDENCIES</a></li>

    <li><a href="#INCOMPATIBILITIES">INCOMPATIBILITIES</a></li>

    <li><a href="#BUGS-AND-LIMITATIONS">BUGS AND
    LIMITATIONS</a></li>

    <li><a href="#SEE-ALSO">SEE ALSO</a></li>

    <li><a href="#LICENSE-AND-COPYRIGHT">LICENSE AND
    COPYRIGHT</a></li>

    <li><a href="#AUTHOR">AUTHOR</a></li>
  </ul>

  <h1 id="NAME">NAME</h1>

  <p>rpmrestore.pl - restore attributes from rpm database</p>

  <h1 id="DESCRIPTION">DESCRIPTION</h1>

  <p>The rpm database store user, group, time, mode for all files,
  and offer a command (rpm -V ) to display a summary of the changes
  between install state (database) and current disk state.
  Rpmrestore can display detailed changes and can restore install
  attributes.</p>

  <h1 id="SYNOPSIS">SYNOPSIS</h1>

  <p>rpmrestore.pl [options] [ target ]</p>

  <p>target:</p>
  <pre>
<code>   file|package         file or package
   -package package     (deprecated) apply on designed package
   -file filename       (deprecated) apply on designed file</code>
</pre>

  <p>options:</p>
  <pre>
<code>   -help                brief help message
   -man                 full documentation
   -V, --version        print version

   -verbose             verbose
   -batch               batch mode (ask no questions)
   -n, --dry-run        do not perform any change
   -log logfile         log action in logfile
   -rollback logfile    restore attributes from logfile (written by -log)

  -all          apply on all attributes
  -user         apply on user
  -group        apply on group
  -mode         apply on mode
  -time         apply on mtime
  -size         apply on size (just display)
  -md5          apply on md5 (just display)
  -capability   apply on capabilities</code>
</pre>

  <h1 id="REQUIRED-ARGUMENTS">REQUIRED ARGUMENTS</h1>

  <p>you should provide a target, to work on</p>

  <p>this can be</p>

  <dl>
    <dt id="package"><b>-package</b></dt>

    <dd>
      <p>The program works on designed installed rpm package.</p>
    </dd>

    <dt id="file"><b>-file</b></dt>

    <dd>
      <p>The program works on designed file, which should be a part
      from a rpm package.</p>
    </dd>

    <dt id="rollback"><b>-rollback</b></dt>

    <dd>
      <p>The program works from designed log file, and rollback
      (revert) the changes.</p>
    </dd>
  </dl>

  <h1 id="OPTIONS">OPTIONS</h1>

  <dl>
    <dt id="help"><b>-help</b></dt>

    <dd>
      <p>Print a brief help message and exits.</p>
    </dd>

    <dt id="man"><b>-man</b></dt>

    <dd>
      <p>Print the manual page and exits.</p>
    </dd>

    <dt id="version"><b>-version</b></dt>

    <dd>
      <p>Print the program release and exit.</p>
    </dd>

    <dt id="verbose"><b>-verbose</b></dt>

    <dd>
      <p>The program works and print debugging messages.</p>
    </dd>

    <dt id="batch"><b>-batch</b></dt>

    <dd>
      <p>The program works without interactive questions (the
      default mode is interactive)</p>
    </dd>

    <dt id="dryrun"><b>-dryrun</b></dt>

    <dd>
      <p>The program just show the changes but not perform any
      restore</p>
    </dd>

    <dt id="log"><b>-log</b></dt>

    <dd>
      <p>The program write the changes in designed log file. This
      file can be used for rollback.</p>
    </dd>

    <dt id="package1"><b>-package</b></dt>

    <dd>
      <p>(deprecated) The program works on designed installed rpm
      package.</p>
    </dd>

    <dt id="file1"><b>-file</b></dt>

    <dd>
      <p>(deprecated) The program works on designed file, which
      should be a part from a rpm package.</p>
    </dd>

    <dt id="rollback1"><b>-rollback</b></dt>

    <dd>
      <p>The program works from designed log file, and rollback
      (revert) the changes.</p>
    </dd>

    <dt id="all"><b>-all</b></dt>

    <dd>
      <p>If no attribute are specified, the program work on all, as
      if this flag is set. It is the same as : -user -group -mode
      -time -size -md5</p>
    </dd>

    <dt id="user"><b>-user</b></dt>

    <dd>
      <p>This is the owner attribute</p>
    </dd>

    <dt id="group"><b>-group</b></dt>

    <dd>
      <p>This is the group attribute</p>
    </dd>

    <dt id="mode"><b>-mode</b></dt>

    <dd>
      <p>This is the file permissions : read-write-execute for
      user, group, other</p>
    </dd>

    <dt id="time"><b>-time</b></dt>

    <dd>
      <p>This attribute is the date of last changes on file.</p>
    </dd>

    <dt id="size"><b>-size</b></dt>

    <dd>
      <p>This is the file size attribute. This is a "read-only"
      attribute : it can not be restored by the program.</p>
    </dd>

    <dt id="md5"><b>-md5</b></dt>

    <dd>
      <p>md5 is a checksum (a kind of fingerprint) : if the file
      content is changed, the checksum will change too. A
      difference on this attribute means the file content was
      changed. This is a "read-only" attribute : it can not be
      restored by the program.</p>
    </dd>

    <dt id="capability"><b>-capability</b></dt>

    <dd>
      <p>capability means for posix capability. This is not
      available on all linux distributions. You can look
      getcap/setcap man pages for more informations.</p>
    </dd>
  </dl>

  <h1 id="USAGE">USAGE</h1>

  <p>the rpm command to control changes on rpm package</p>
  <pre>
<code>  rpm -V rpm</code>
</pre>

  <p>same effect (just display) but more detailed (display
  values)</p>
  <pre>
<code>  rpmrestore.pl -n rpm</code>
</pre>

  <p>interactive change mode, only on time attribute</p>
  <pre>
<code>  rpmrestore.pl -time rpm</code>
</pre>

  <p>interactive change mode, on all attributes except time
  attribute</p>
  <pre>
<code>  rpmrestore.pl -all -notime rpm</code>
</pre>

  <p>batch change mode (DANGEROUS) on mode attribute with log
  file</p>
  <pre>
<code>  rpmrestore.pl -batch -log /tmp/log rpm</code>
</pre>

  <p>interactive change of mode attribute on file /etc/motd</p>
  <pre>
<code>  rpmrestore.pl -mode /etc/motd</code>
</pre>

  <p>interactive rollback from /tmp/log</p>
  <pre>
<code>  rpmrestore.pl -rollback /tmp/log</code>
</pre>

  <p>batch rollback user changes from /tmp/log</p>
  <pre>
<code>  rpmrestore.pl -batch -user -rollback /tmp/log</code>
</pre>

  <h1 id="CONFIGURATION">CONFIGURATION</h1>

  <p>the program can read rcfile if some exists. it will load in
  order</p>

  <p>/etc/rpmrestorerc</p>

  <p>~/.rpmrestorerc</p>

  <p>.rpmrestorerc</p>

  <p>In this file,</p>

  <p># are comments,</p>

  <p>and parameters are stored in the following format : parameter
  = value</p>

  <p>example :</p>

  <p>verbose = 0</p>

  <p>dry-run = 1</p>

  <p>batch = 0</p>

  <h1 id="NOTES">NOTES</h1>

  <p>you should be superuser to restore attributes, other users can
  only check changes</p>

  <p>on batch mode, we recommend to use log file</p>

  <h1 id="DIAGNOSTICS">DIAGNOSTICS</h1>

  <p>(to be filled)</p>

  <h1 id="EXIT-STATUS">EXIT STATUS</h1>

  <p>the program should allways exit with code 0</p>

  <h1 id="DEPENDENCIES">DEPENDENCIES</h1>

  <p>this program uses "standard" perl modules (distributed with
  perl core) : POSIX Digest::MD5 English Getopt::Long Pod::Usage
  POSIX Digest::MD5 File::stat Data::Dumper</p>

  <h1 id="INCOMPATIBILITIES">INCOMPATIBILITIES</h1>

  <p>none is known</p>

  <h1 id="BUGS-AND-LIMITATIONS">BUGS AND LIMITATIONS</h1>

  <p>this program can revert changes on user, group, time,
  properties, but not on size and md5 : it can only show the
  differences</p>

  <h1 id="SEE-ALSO">SEE ALSO</h1>

  <h1 id="LICENSE-AND-COPYRIGHT">LICENSE AND COPYRIGHT</h1>

  <p>Copyright (C) 2006 by Eric Gerbier This program is free
  software; you can redistribute it and/or modify it under the
  terms of the GNU General Public License as published by the Free
  Software Foundation; either version 2 of the License, or (at your
  option) any later version.</p>

  <h1 id="AUTHOR">AUTHOR</h1>

  <p>Eric Gerbier</p>

  <p>you can report any bug or suggest to
  gerbier@users.sourceforge.net</p>

  <table border="0" width="100%" cellspacing="0" cellpadding="3"
  summary="">
    <tr>
      <td class="_podblock_" style="background-color: #cccccc"
      valign="middle"><big><strong><span class=
      "_podblock_">&nbsp;</span></strong></big></td>
    </tr>
  </table>
</body>
</html>
